{
  "step_anchor": "#step-2",
  "approach": "Create a new worktree.rs module in specks-core that provides the core worktree management functionality. This module will contain WorktreeConfig struct, functions for deriving speck slugs, sanitizing branch names, creating/listing/cleaning up worktrees, and managing the worktree lifecycle. The implementation uses std::process::Command to execute git commands with the -C flag for worktree operations, following the established pattern in beads.rs.",
  "expected_touch_set": [
    "crates/specks-core/src/worktree.rs",
    "crates/specks-core/src/lib.rs",
    "crates/specks-core/src/error.rs"
  ],
  "implementation_steps": [
    {
      "order": 1,
      "description": "Add worktree-specific error variants to SpecksError enum in error.rs"
    },
    {
      "order": 2,
      "description": "Create worktree.rs module with WorktreeConfig struct and derive_speck_slug, sanitize_branch_name functions"
    },
    {
      "order": 3,
      "description": "Implement generate_timestamp_utc() and generate_branch_name() helpers"
    },
    {
      "order": 4,
      "description": "Implement GitCli wrapper struct for git operations"
    },
    {
      "order": 5,
      "description": "Implement create_worktree() with partial failure recovery"
    },
    {
      "order": 6,
      "description": "Implement list_worktrees()"
    },
    {
      "order": 7,
      "description": "Implement cleanup_worktrees() with dry_run mode"
    },
    {
      "order": 8,
      "description": "Add comprehensive unit tests"
    },
    {
      "order": 9,
      "description": "Export worktree module from lib.rs"
    }
  ],
  "test_plan": "Run cargo build -p specks-core to verify compilation. Run cargo nextest run -p specks-core worktree for unit tests.",
  "risks": [
    "Integration tests require git repository context",
    "Parse speck to count steps - must handle errors",
    "Git version check may behave differently across platforms",
    "Partial failure recovery is complex"
  ]
}
